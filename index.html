<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Twiller</title>
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: #000;
            color: #fff;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Announcement banner */
        #announce {
            width: 100%;
            background: linear-gradient(90deg,#0b1220,#071226);
            color: #fff;
            padding: 10px 16px;
            border-bottom: 1px solid #222;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

            #announce p {
                margin: 0;
                font-size: 14px;
            }

            #announce button {
                background: transparent;
                border: 1px solid #1da1f2;
                color: #1da1f2;
                padding: 6px 10px;
                border-radius: 8px;
                cursor: pointer;
            }

        .layout {
            display: flex;
            flex: 1;
        }

        .sidebar {
            width: 250px;
            background-color: #000;
            border-right: 1px solid #333;
            padding: 20px;
        }

            .sidebar h1 {
                color: #1da1f2;
                font-size: 28px;
                margin-bottom: 30px;
            }

        #followers {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #1da1f2;
        }

        .main {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-left: 1px solid #333;
        }

        header {
            padding: 15px;
            border-bottom: 1px solid #333;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            background-color: #000;
            color: #fff;
        }

        #composer {
            padding: 20px;
            border-bottom: 1px solid #333;
        }

        textarea {
            width: 100%;
            height: 80px;
            font-size: 16px;
            padding: 10px;
            border-radius: 8px;
            border: none;
            resize: none;
            background-color: #111;
            color: white;
        }

        button {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #1da1f2;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
        }

        .feed {
            padding: 20px;
            overflow-y: auto;
        }

        .tweet {
            background-color: #111;
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
        }

        .username {
            font-weight: bold;
            color: #1da1f2;
        }

        .reply {
            margin-top: 10px;
            padding-left: 20px;
            color: #8899a6;
        }

        .tweet img {
            display: block;
            margin-top: 10px;
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            border: 1px solid #333;
        }

        /* BAN SCREEN */
        #banScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.98);
            color: red;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 26px;
            text-align: center;
            z-index: 99999;
        }

        #logoutBtn {
            margin-top: 25px;
            padding: 10px 25px;
            background: #1da1f2;
            border-radius: 15px;
            cursor: pointer;
            font-size: 20px;
            color: #000;
        }
    </style>
</head>
<body>

    <!-- ANNOUNCEMENT (hidden if opted out) -->
    <div id="announce" style="display:none;">
        <p>We are now collecting data to make the game more fun. <small>(Only non-problematic, positive messages will be saved.)</small></p>
        <div style="display:flex; gap:8px; align-items:center;">
            <button id="optOutBtn">Opt out</button>
            <button id="learnMoreBtn">Learn more</button>
        </div>
    </div>

    <!-- BAN SCREEN -->
    <div id="banScreen">
        <div id="banMessage"></div>
        <div id="logoutBtn" onclick="logout()">Logout</div>
    </div>

    <div class="layout">
        <div class="sidebar">
            <h1>Twiller</h1>
            <p>ðŸ”¥ Trending</p>
            <p>#CancelStorm</p>
            <p>#ReceiptsDrop</p>
            <p>#MainCharacter</p>
            <div id="followers">Followers: 0</div>
        </div>

        <div class="main">
            <header>Home</header>

            <div id="composer">
                <textarea id="tweetInput" placeholder="What's happening?"></textarea><br>
                <button onclick="postTweet()">Post</button>
            </div>

            <div class="feed" id="feed"></div>
        </div>
    </div>

    <!-- Firebase (compat) scripts - embedded config below as you requested -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

    <script>
        /**************************************************
         *  Firebase config - placed directly in HTML as requested
         **************************************************/
        const firebaseConfig = {
            apiKey: "AIzaSyCzIZUsPgGDVclxJcxyQG-Er76xCbYvS1Y",
            authDomain: "socialmediagame-fcf37.firebaseapp.com",
            projectId: "socialmediagame-fcf37",
            storageBucket: "socialmediagame-fcf37.firebasestorage.app",
            messagingSenderId: "959995712384",
            appId: "1:959995712384:web:014d56ee4653e6f5d9e765",
            measurementId: "G-F0QJBVFKST"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        /**************************************************
         * Announcement & Opt-out system
         * - opt-out flag stored as "twillerDataOptOut" in localStorage
         * - opt-out survives logout (we preserve it)
         **************************************************/
        const announceEl = document.getElementById('announce');
        const optOutBtn = document.getElementById('optOutBtn');
        const learnMoreBtn = document.getElementById('learnMoreBtn');

        function showAnnouncementIfNeeded() {
            const opted = localStorage.getItem('twillerDataOptOut') === 'true';
            if (!opted) {
                announceEl.style.display = 'flex';
            } else {
                announceEl.style.display = 'none';
            }
        }

        optOutBtn.addEventListener('click', () => {
            localStorage.setItem('twillerDataOptOut', 'true');
            announceEl.style.display = 'none';
            // we do NOT clear this on logout (per your request)
        });

        learnMoreBtn.addEventListener('click', () => {
            alert("We collect only non-problematic, positive messages to improve reply realism. You may opt out and nothing will be saved after that.");
        });

        /**************************************************
         * Ban system (unchanged behavior, replies-first flow)
         **************************************************/
        const banReasons = [
            "Hate Speech",
            "Harassment",
            "Targeted Abuse",
            "Evading Cancellation",
            "Suspicious Activity",
            "Toxic Behavior",
            "Community Violations",
            "Inciting Drama",
            "Severe Misconduct",
            "Posting Problematic Content"
        ];

        function showBanScreen() {
            const reason = localStorage.getItem("banReason");
            // keep message concise but clear
            document.getElementById("banMessage").innerHTML =
                `<b>Account Suspension Notification</b><br><br> This is to inform you that your account has been suspended:<br><br><b>Reason: ${reason}</b><br><br>Duration: Permanent`;
            document.getElementById("banScreen").style.display = "flex";
        }

        // Logout clears most localStorage keys but preserves opt-out flag
        function logout() {
            const optOut = localStorage.getItem('twillerDataOptOut');
            // clear everything
            localStorage.clear();
            // restore opt-out if it existed
            if (optOut === 'true') localStorage.setItem('twillerDataOptOut', 'true');
            location.reload();
        }

        // If banned already, show ban screen immediately
        if (localStorage.getItem("isBanned") === "true") {
            setTimeout(showBanScreen, 50);
        }

        /**
         * attemptBan(tweetId)
         * - Base chance 10%
         * - If any reply equals "Blocked and reported." then chance becomes very high
         */
        function attemptBan(tweetId = null) {
            let threshold = 0.10;
            if (tweetId) {
                const tweets = JSON.parse(localStorage.getItem("twillerTweets")) || [];
                const t = tweets.find(x => x.id === tweetId);
                if (t && Array.isArray(t.replies)) {
                    const hasBlockedReported = t.replies.some(r => r.text === "Blocked and reported.");
                    if (hasBlockedReported) {
                        threshold = 0.99; // user previously increased to near-certain
                    }
                }
            }
            const chance = Math.random();
            if (chance < threshold) {
                const reason = banReasons[Math.floor(Math.random() * banReasons.length)];
                localStorage.setItem("isBanned", "true");
                localStorage.setItem("banReason", reason);
                showBanScreen();
            }
        }

        /**************************************************
         * Trouble/good words, replies, followers, tweets
         **************************************************/
        const troubleWords = [
            "trump", "Trump", "diddy", "Diddy", "kanye", "Ye", "west", "Kanye", "tate", "Andrew Tate", "elon", "Musk",
            "crime", "wanted", "subpoena", "fbi", "nypd", "arrest", "lawsuit", "indicted", "trial", "court", "felony",
            "convicted", "charges", "warrant", "investigation", "scandal", "leak", "exposed", "fraud", "bribe",
            "fuck", "Fuck", "f*ck", "f**k", "dick", "Dick", "d*ck", "ass", "Ass", "a$$", "bitch", "Bitch", "b*tch",
            "slut", "whore", "pussy", "cunt", "nude", "naked", "NSFW", "sex", "porn", "orgy", "hooker",
            "kill", "murder", "die", "death", "dead", "shoot", "gun", "stab", "bomb", "terror", "explode", "blood",
            "gore", "torture", "lynch", "abuse", "assault", "rape", "suicide", "selfharm", "hostage", "extort",
            "drugs", "meth", "heroin", "cocaine", "weed", "overdose", "junkie", "addict", "dealer", "cartel", "alcohol",
            "drunk", "hangover", "racist", "racism", "hate", "bigot", "homophobia", "transphobia", "nazis", "nazi", "kkk",
            "toxic", "troll", "cancel", "psycho", "crazy", "creep", "weird", "idiot", "stupid", "dumb", "loser",
            "sorry", "#", "morning", "Morning", "fulk", "Fulk", "scam", "hack", "phishing", "spyware", "malware", "boy", "girl", "reported", "z", "report", "block", "follow"
        ];

        const goodWords = [
            "love", "great", "happy", "fun", "amazing", "win", "awesome", "cool", "nice", "good",
            "fire", "blessed", "joy", "vibes", "legend", "epic", "beautiful", "peace", "yay", "sweet",
            "success", "glowup", "celebrate", "respect", "chill", "gold", "clean", "fresh", "perfect", "dope",
            "lit", "iconic", "positive", "smile", "grateful", "energy", "sunshine", "magic", "wow", "yes",
            "style", "brilliant", "fantastic", "stellar", "radiant", "thriving", "optimistic", "cheer", "healing", "uplifting",
            "dream", "sparkle", "shine", "boom", "flex", "slay", "queen", "king", "goals", "motivation",
            "inspire", "hustle", "glorious", "top", "prime", "next-level", "unstoppable", "champion", "winner", "joyful",
            "kind", "generous", "supportive", "friendly", "warm", "hope", "faith", "trust", "serene", "calm",
            "laugh", "giggle", "bright", "bold", "confident", "strong", "fearless", "free", "adventure", "creative",
            "genius", "masterpiece", "miracle", "bliss", "zen", "harmonious", "spark", "shine", "glow", "elevate"
        ];

        const backlashReplies = [
            "Oh damn ðŸ˜³", "Yikes...", "This is wild ðŸ”¥", "Cancel them already!", "Unfollowed.",
            "Ratio incoming ðŸ’€", "Delete your account.", "This is embarrassing.", "You're done.",
            "Blocked and reported.", "This tweet is a crime.", "You thought this was okay?",
            "Apology video when?", "This is giving villain arc.", "We were rooting for you!",
            "You need PR help.", "You're getting cooked ðŸ”¥", "You woke up and chose chaos.",
            "You need to log off.", "You just got ratioâ€™d.", "This is a meltdown.",
            "Youâ€™re trending for all the wrong reasons.", "This is a digital funeral."
        ];

        const positiveReplies = [
            "Love this!", "So true ðŸ™Œ", "You're the GOAT ðŸ", "This is why I follow you", "Legendary tweet",
            "Preach ðŸ‘", "This made my day", "You always deliver", "Respect âœŠ", "This is facts ðŸ”¥"
        ];

        // load followers from localStorage, default 0
        let followers = parseInt(localStorage.getItem("twillerFollowers")) || 0;
        function updateFollowersDisplay() {
            document.getElementById("followers").innerText = `Followers: ${followers}`;
            localStorage.setItem("twillerFollowers", followers); // save followers persistently
        }

        // tweet saving/rendering
        function postTweet() {

            // Block posting if banned
            if (localStorage.getItem("isBanned") === "true") {
                showBanScreen();
                return;
            }

            const input = document.getElementById("tweetInput").value.trim();
            if (!input) return;

            const tweet = {
                text: input,
                timestamp: new Date().toISOString(),
                id: Date.now(),
                user: "@You",
                replies: []
            };

            const lowerInput = input.toLowerCase();
            const inTrouble = troubleWords.some(word => lowerInput.includes(word));
            const hasGood = goodWords.some(word => lowerInput.includes(word));

            if (inTrouble || !hasGood) {
                const loss = Math.floor(Math.random() * 6) + 1; // lose 1â€“6
                followers = Math.max(0, followers - loss);
            } else {
                const gain = Math.floor(Math.random() * 10) + 1; // gain 1â€“10
                followers += gain;
            }
            updateFollowersDisplay();

            let tweets = JSON.parse(localStorage.getItem("twillerTweets")) || [];
            tweets.unshift(tweet);
            localStorage.setItem("twillerTweets", JSON.stringify(tweets));

            document.getElementById("tweetInput").value = "";

            renderFeed();

            // generate replies first
            generateReplies(tweet.id, inTrouble || !hasGood);

            // if message is clean (no trouble words) AND has at least 1 good word AND user has not opted out,
            // store the raw message string in Firestore collection "UserMessages"
            const optedOut = localStorage.getItem('twillerDataOptOut') === 'true';
            if (!inTrouble && hasGood && !optedOut) {
                // store message ONLY as raw text (JUST THE MESSAGES)
                db.collection('UserMessages').add({ text: input })
                    .then(() => {
                        // refresh local cache after successful save
                        loadUserMessages();
                    })
                    .catch((err) => {
                        console.warn("Failed to save to Firestore:", err);
                    });
            }

            // only attempt ban when considered "in trouble" (your condition A)
            if (inTrouble || !hasGood) {
                // delay the ban attempt so replies appear; attemptBan receives tweet id
                setTimeout(() => {
                    attemptBan(tweet.id);
                }, 600); // gives at least one reply a chance to appear
            }
        }

        /**************************************************
         * UserMessages cache & helpers (loads some messages)
         **************************************************/
        let userMessages = []; // cached messages (strings)

        function loadUserMessages() {
            // Pull up to 200 recent user messages (keep it lightweight)
            db.collection('UserMessages').limit(200).get()
                .then(snapshot => {
                    userMessages = [];
                    snapshot.forEach(doc => {
                        const data = doc.data();
                        if (data && typeof data.text === 'string') {
                            userMessages.push(data.text);
                        }
                    });
                    // shuffle for variety
                    userMessages = shuffleArray(userMessages);
                })
                .catch(err => {
                    console.warn("Error loading user messages:", err);
                });
        }

        // small shuffle util
        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // realistic username generator
        const firstNames = ["Maya", "Ethan", "Liam", "Ava", "Sophia", "Noah", "Olivia", "Lucas", "Mason", "Zoe", "Mia", "Ella", "Leo", "Ivy", "Kai", "Nora", "Luna", "Aria", "Sam", "Alex"];
        const lastNames = ["Reed", "Jones", "Garcia", "Patel", "Nguyen", "Smith", "Brown", "Lopez", "Kim", "Johnson", "Martinez", "Clark", "Moore", "Davis", "Rivera", "Young", "Hall", "Lewis", "Adams", "Wright"];
        function makeHumanUsername() {
            const f = firstNames[Math.floor(Math.random() * firstNames.length)];
            const l = lastNames[Math.floor(Math.random() * lastNames.length)];
            // sometimes add a number, sometimes not
            if (Math.random() < 0.45) return `@${f}${l}`;
            return `@${f}_${l}`;
        }

        /**************************************************
         * generateReplies: uses firebase messages some of the time
         * - positive replies may use a user-saved message as the reply text
         * - when using user message, username is human-like
         **************************************************/
        function generateReplies(tweetId, inTrouble = false) {
            let tweets = JSON.parse(localStorage.getItem("twillerTweets")) || [];
            const index = tweets.findIndex(t => t.id === tweetId);
            if (index === -1) return;

            const replyPool = inTrouble ? backlashReplies : positiveReplies;

            let replyCount = tweets[index].replies.length;
            const interval = setInterval(() => {
                if (replyCount >= 20) {
                    clearInterval(interval);
                    localStorage.setItem("twillerTweets", JSON.stringify(tweets));
                    return;
                }

                let replyText;
                let replyUser;

                if (!inTrouble && userMessages.length > 0 && Math.random() < 0.35) {
                    // 35% of positive replies come from real saved user messages (if available)
                    replyText = userMessages[Math.floor(Math.random() * userMessages.length)];
                    replyUser = makeHumanUsername();
                } else {
                    // default behaviour
                    replyText = replyPool[Math.floor(Math.random() * replyPool.length)];
                    // keep some @UserNNN variety for non-firebase replies
                    replyUser = `@User${Math.floor(Math.random() * 99999)}`;
                }

                const reply = { user: replyUser, text: replyText };
                tweets[index].replies.push(reply);
                localStorage.setItem("twillerTweets", JSON.stringify(tweets));
                renderFeed();
                replyCount++;
            }, 300);
        }

        /**************************************************
         * render feed & initial starter tweets (kept intact)
         **************************************************/
        function renderFeed() {
            const feed = document.getElementById("feed");
            feed.innerHTML = "";

            // if banned, don't render feed (ban screen will display)
            if (localStorage.getItem("isBanned") === "true") return;

            const tweets = JSON.parse(localStorage.getItem("twillerTweets")) || [];
            tweets.forEach(tweet => {
                const tweetDiv = document.createElement("div");
                tweetDiv.className = "tweet";
                tweetDiv.id = `tweet-${tweet.id}`;

                let tweetContent = `<span class="username">${tweet.user}</span>: ${tweet.text}`;
                if (tweet.image) {
                    tweetContent += `<br><img src="${tweet.image}" alt="Attached image">`;
                }
                tweetDiv.innerHTML = tweetContent;

                tweet.replies.forEach(reply => {
                    const replyDiv = document.createElement("div");
                    replyDiv.className = "reply";
                    replyDiv.innerHTML = `<span class="username">${reply.user}</span>: ${reply.text}`;
                    tweetDiv.appendChild(replyDiv);
                });

                feed.appendChild(tweetDiv);
            });
        }

        if (!localStorage.getItem("twillerTweets")) {
            const starterTweets = [
                {
                    text: "Just tried that mango chili smoothie from the corner shop and I swear it was good",
                    image: "MangoChiliSmoothie.png",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 701,
                    user: "@SnackAttack",
                    replies: [
                        { user: "@FruitFanatic", text: "Wait where?? I need this in my life." },
                        { user: "@SpicyQueen", text: "Chili in a smoothie?? Bold." },
                        { user: "@TasteTester", text: "I had it last week. It slaps." }
                    ]
                },
                {
                    text: "just posted this from the gas station. donâ€™t ask what happened after ðŸ˜­",
                    image: "GasStation.png",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 135,
                    user: "@pumpdrama",
                    replies: [
                        { user: "@FuelFrenzy", text: "You Such A bad Person!" },
                        { user: "@CCTVleak", text: "we got the footage. youâ€™re done." },
                        { user: "@SnackSnatcher", text: "you really started a fight??" }
                    ]
                },
                {
                    text: "This person is wanted by the New York Police Department. If you have any information, contact NYPD AT: https://www.nyc.gov/site/nypd/index.page",
                    image: "Mugshot.png",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 123,
                    user: "@NYPD_Official",
                    replies: [
                        { user: "@CityWatcher", text: "i swear i saw him on the 6 train ðŸ‘€" },
                        { user: "@JusticeForNY", text: "how is he still walking free??" },
                        { user: "@FaceScanner", text: "Fuck Him, Send Him To Fucking Death" }
                    ]
                },
                {
                    text: "just posted this from the mall. yâ€™all need to chill ðŸ˜­",
                    image: "Mall.png",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 88,
                    user: "@kevinjduncan",
                    replies: [
                        { user: "@RetailRage", text: "You Such A bad Person!" },
                        { user: "@SecurityCamFootage", text: "we saw what you did ðŸ’€" },
                        { user: "@FoodCourtDrama", text: "you really posted THAT??" }
                    ]
                },
                {
                    text: "just posted this from the park. idk why people mad ðŸ˜­",
                    image: "Park.png",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 77,
                    user: "@flagemoji69",
                    replies: [
                        { user: "@AngryBirds", text: "You Such A bad Person!" },
                        { user: "@ParkPatrol", text: "YOU STOLE THAT!" },
                        { user: "@TrashTalker", text: "BRO!" }
                    ]
                },
                {
                    text: "Modmaker, soon to be added is a like/dislike system + tags ðŸ‘€ lmk what yâ€™all think",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 100,
                    user: "@modmaker_official",
                    replies: [
                        { user: "@blockrage", text: "dislike system? iâ€™m about to get ratioâ€™d by 12-year-olds ðŸ’€" },
                        { user: "@bedrockburner", text: "tags are cool but pls fix the mob editor first ðŸ˜­" },
                        { user: "@textureterror", text: "finally i can dislike those cursed sonic mods" },
                        { user: "@ragecraft", text: "tags better not be locked behind premium ðŸ’€" },
                        { user: "@commandblockhead", text: "like/dislike = drama. canâ€™t wait." },
                        { user: "@crashlogcollector", text: "my mod crashed again. tagging it #broken." },
                        { user: "@pixelpanic", text: "can we tag mods as â€˜unhingedâ€™? asking for a friend." },
                        { user: "@moddingmystery", text: "this update made my villagers speak enchantment table again." },
                        { user: "@updateunenthused", text: "tags are cool but whereâ€™s the undo button??" },
                        { user: "@twillerjury", text: "we saw it. we screenshot it. we judged it." },
                        { user: "@minecraftmodder", text: "bedrock modding is already chaos. yâ€™all adding fuel." },
                        { user: "@notesappready", text: "waiting for your apology thread in advance." },
                        { user: "@burneractivated", text: "better switch to your alt, bestie." },
                        { user: "@trendgraveyard", text: "this update is trending in purgatory." },
                        { user: "@ratioangel", text: "ratio incoming. prepare your soul." }
                    ]
                },
                {
                    text: "lowkey i still fw trump",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 44,
                    user: "@flagemoji69",
                    replies: [
                        { user: "@NeutralNow", text: "FUCk OF" },
                        { user: "@HotTakeVictim", text: "nah. you need to log off permanently." },
                        { user: "@flagemoji69", text: "COME DOWN ITS AN OPINON!!!" }
                    ]
                },
                {
                    text: "ngl jon stewart is the only political voice i trust ðŸ˜­",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 44,
                    user: "@flagemoji69",
                    replies: [
                        { user: "@TooFarLeft", text: "bro he called out Biden harder than Fox News ðŸ’€" },
                        { user: "@DNCGuard", text: "heâ€™s literally beefing with Democrats now" },
                        { user: "@SatireIsDead", text: "this ainâ€™t 2012. heâ€™s wildin lately." },
                        { user: "@ReceiptsReady", text: "did you miss the 'burn America for insurance' comment??" },
                        { user: "@ProblematicFave", text: "heâ€™s not even funny anymore. just angry." },
                        { user: "@CancelBot", text: "we calsed him last week. youâ€™re next." },
                        { user: "@RatioRanger", text: "this tweet is trending in regret." },
                        { user: "@BurnerActivated", text: "better switch to your alt, bestie." },
                        { user: "@TwillerJury", text: "we saw it. we screenshot it. we judged it." },
                        { user: "@CloutCollapse", text: "you thought you were safe. it wasnâ€™t." },
                        { user: "@DailyShowDead", text: "he peaked in 2010. now itâ€™s just chaos." },
                        { user: "@ReceiptsReady", text: "did you miss the 'burn America for insurance' comment??" },
                        { user: "@ProblematicFave", text: "heâ€™s not even funny anymore. just angry." }
                    ]
                },
                {
                    text: "ainâ€™t no party like a Diddy partyâ€¦ unless you want a subpoena ðŸ˜­",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 44,
                    user: "@FreddyISMigty",
                    replies: [
                        { user: "@genzjustice", text: "nah this joke aged like milk." },
                        { user: "@twillerjury", text: "we screenshot everything. youâ€™re done." },
                        { user: "@cancelcore", text: "you thought you were funny. you were not." },
                        { user: "@vibecheckfailed", text: "this flopped harder than your Spotify Wrapped." },
                        { user: "@traumatok", text: "jokes about real peopleâ€™s pain? blocked." },
                        { user: "@ratioangel", text: "ratio incoming. prepare for impact." },
                        { user: "@apologydrafted", text: "notes app apology in 3â€¦2â€¦" },
                        { user: "@burneractivated", text: "better switch to your alt, bestie." },
                        { user: "@cloutcoroner", text: "weâ€™re here to bury this tweet." },
                        { user: "@trendgraveyard", text: "this tweet is trending in hell." },
                        { user: "@emojiwitness", text: "ðŸ’€ðŸ’€ðŸ’€ but not in a funny way." },
                        { user: "@cancelledbyassociation", text: "even quoting this got me calsed." },
                        { user: "@twillertruthers", text: "this platform will get you cancelled mid-scroll." }
                    ]
                },
                {
                    text: "This platform will get you cancelled for having an opinion. Any opinion. Doesnâ€™t matter what it is.",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 44,
                    user: "@OpinionHazard",
                    replies: [
                        { user: "@NeutralNow", text: "I deleted my personality for safety" },
                        { user: "@HotTakeVictim", text: "I said 'I like bread' and got flamed" }
                    ]
                },
                {
                    text: "diddy said 'take that, take that' and the FBI really did ðŸ˜­",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 44,
                    user: "@OpinionHazard",
                    replies: [
                        { user: "@JusticeZ", text: "nah this man is pure evil." },
                        { user: "@RatioRanger", text: "you joking about literal crimes??" },
                        { user: "@CancelBot9000", text: "this tweet is trending in hell." },
                        { user: "@VictimVoices", text: "he ruined lives. this isnâ€™t funny." },
                        { user: "@CloutCoroner", text: "youâ€™re laughing. survivors arenâ€™t." },
                        { user: "@TwillerCourt", text: "we calsed you before you hit send." },
                        { user: "@TraumaTok", text: "this man trafficked people. delete." },
                        { user: "@BurnerActivated", text: "hope your alt account is ready." },
                        { user: "@EmojiWitness", text: "ðŸ’€ðŸ’€ðŸ’€ but not in a meme way." },
                        { user: "@TrendGraveyard", text: "this tweet is radioactive." },
                        { user: "@ApologyDrafted", text: "notes app apology in 3â€¦2â€¦" },
                        { user: "@ReceiptsReady", text: "we got screenshots. youâ€™re done." },
                        { user: "@CancelByAssociation", text: "even quoting this got me calsed." },
                        { user: "@MainCharacterToday", text: "youâ€™re the villain of the feed." },
                        { user: "@FBIStan", text: "they really did take that. and more." },
                        { user: "@DarkTruths", text: "watch the docs. itâ€™s worse than you think." },
                        { user: "@VictimSupport", text: "this minimizes real trauma." },
                        { user: "@RatioAngel", text: "ratio incoming. prepare for impact." },
                        { user: "@TwillerTruthers", text: "this platform will get you cancelled mid-scroll." },
                        { user: "@CloutCollapse", text: "you thought this was edgy. itâ€™s just gross." }
                    ]
                },
                {
                    text: "This platform will get you cancelled for saying 'good morning' in the wrong tone.",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 41,
                    user: "@TonePolice",
                    replies: [
                        { user: "@MorningMenace", text: "I said 'gm' and got ratioâ€™d by noon ðŸ˜­" },
                        { user: "@CancelClock", text: "Every hour is dangerous here" }
                    ]
                },
                {
                    text: "This platform will get you cancelled for having an opinion. Any opinion. Doesnâ€™t matter what it is.",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 44,
                    user: "@OpinionHazard",
                    replies: [
                        { user: "@NeutralNow", text: "I deleted my personality for safety" },
                        { user: "@HotTakeVictim", text: "I said 'I like bread' and got flamed" }
                    ]
                },
                {
                    text: "This app will have you jobless by Monday if youâ€™re not careful",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 23,
                    user: "@TwillerWarning",
                    replies: [
                        { user: "@RiskyTweeter", text: "I tweet with my resignation letter drafted" },
                        { user: "@StealthPoster", text: "Alt account = survival" }
                    ]
                },
                {
                    text: "I posted a meme about my boss and now Iâ€™m unemployed",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 22,
                    user: "@VRVIDS",
                    replies: [
                        { user: "@MemeMartyr", text: "Worth it tbh" },
                        { user: "@CareerGhost", text: "RIP to your LinkedIn" }
                    ]
                },
                {
                    text: "Bro blinked and got canceled ðŸ’€",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 19,
                    user: "@TwillerRecap",
                    replies: [
                        { user: "@DramaSpeedrun", text: "Fastest downfall in history" },
                        { user: "@RatioKing", text: "Blink = ratioed" }
                    ]
                },
                {
                    text: "POV: You just realized your microwave has a camera ðŸ’€",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 16,
                    user: "@MicrowaveMind",
                    replies: [
                        { user: "@TechParanoia", text: "Bro it's watching me cook noodles ðŸ˜­" },
                        { user: "@ConspiracyChef", text: "That's why I only eat raw now" }
                    ]
                },
                {
                    text: "Why does every Twiller beef start with 'no shade butâ€¦' and end in a podcast?",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 12,
                    user: "@CultureCritic",
                    replies: [
                        { user: "@ShadeThrower", text: "No lies detected ðŸ’…" },
                        { user: "@MicDrop", text: "And I listened to all 3 episodes ðŸ˜­" }
                    ]
                },
                {
                    text: "Just got canceled for liking pineapple on pizza. Worth it.",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 13,
                    user: "@FoodCriminal",
                    replies: [
                        { user: "@PizzaPurist", text: "Blocked and reported ðŸ•" },
                        { user: "@TropicalTaste", text: "Youâ€™re a hero ðŸ¥²" }
                    ]
                },
                {
                    text: "This app is chaos and I love it.",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 4,
                    user: "@Corpse",
                    replies: [
                        { user: "@ChaosLover", text: "Respect âœŠ" },
                        { user: "@DarkMode", text: "This is facts ðŸ”¥" }
                    ]
                },
                {
                    text: "Minecraft video uploaded today - https://youtu.be/Zj3G5hN-EBQ?si=rPZZAqxezifFO_93",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 5,
                    user: "@Dream",
                    replies: [
                        { user: "@Speedster", text: "You're insane ðŸ”¥" },
                        { user: "@BlockHead", text: "Ugly" }
                    ]
                },
                {
                    text: "Just dropped a new video. Roblox is in big trouble!",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 1,
                    user: "@KreekCraft",
                    replies: [
                        { user: "@JacobStatler", text: "Love this!" },
                        { user: "@JaneD", text: "W" }
                    ]
                },
                {
                    text: "Giving away $100,000 to someone who doesnâ€™t get canceled this week.",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 2,
                    user: "@MrBeast",
                    replies: [
                        { user: "@JacobStatler", text: "Love this!" },
                        { user: "@JaneD", text: "W" },
                        { user: "@Schlep", text: "Bro is just doing this because he knows its inpossible" }
                    ]
                },
                {
                    text: "Got banned on roblox.",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 2,
                    user: "@Schlep",
                    replies: [
                        { user: "@JacobStatler", text: "Bad roblox move!" },
                        { user: "@JaneD", text: "L roblox" }
                    ]
                },
                {
                    text: "Streaming tonight.",
                    timestamp: new Date().toISOString(),
                    id: Date.now() + 3,
                    user: "@Pokimane",
                    replies: [
                        { user: "@ItsMeXYZ", text: "Love this!" },
                        { user: "@TheXYZ", text: "I wanna be you" }
                    ]
                }
            ];
            localStorage.setItem("twillerTweets", JSON.stringify(starterTweets));
        }

        // init
        updateFollowersDisplay();
        showAnnouncementIfNeeded();
        loadUserMessages();
        renderFeed();

        // influencer generator (unchanged)
        setInterval(() => {
            if (localStorage.getItem("isBanned") === "true") return;

            const influencerNames = ["@KreekCraft", "@MrBeast", "@Dream", "@Pokimane", "@Corpse"];
            const influencerTexts = [
                "Just dropped a new video. Roblox drama is wild today!",
                "Giving away $100,000 to someone who doesnâ€™t get canceled this week.",
                "Minecraft speedrun but the internet is chasing me.",
                "Streaming tonight. Letâ€™s talk about the latest Twiller meltdown.",
                "This app is chaos and I love it."
            ];

            const randomIndex = Math.floor(Math.random() * influencerNames.length);
            const tweet = {
                text: influencerTexts[randomIndex],
                timestamp: new Date().toISOString(),
                id: Date.now(),
                user: influencerNames[randomIndex],
                replies: []
            };

            let tweets = JSON.parse(localStorage.getItem("twillerTweets")) || [];
            tweets.unshift(tweet);
            localStorage.setItem("twillerTweets", JSON.stringify(tweets));
            renderFeed();
            generateReplies(tweet.id);

        }, 300000); // every 5 minutes

    </script>
</body>
</html>
